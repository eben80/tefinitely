<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>French Speaking Practice</title>
<style>
body { font-family: Arial; max-width: 700px; margin: auto; }
#chat div { margin: 10px 0; }
.assistant { color: blue; }
.user { color: green; }
</style>
</head>
<body>

<h2>French Speaking Practice</h2>

<select id="level">
  <option value="A1">A1</option>
  <option value="A2">A2</option>
  <option value="B1">B1</option>
</select>
<button onclick="start()">Start</button>

<div id="scenario"></div>
<div id="chat"></div>

<input id="input" placeholder="Votre rÃ©ponse..." style="width:80%">
<button onclick="send()">Send</button>

<script>
async function start() {
  const level = document.getElementById('level').value;

  const res = await fetch('api/start_session.php', {
    method: 'POST',
    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
    body: 'level=' + level
  });

  const data = await res.json();
  document.getElementById('scenario').innerText = data.scenario;
  document.getElementById('chat').innerHTML =
    `<div class="assistant">${data.assistant}</div>`;
}

async function send() {
  const text = document.getElementById('input').value;
  if (!text) return;

  document.getElementById('chat').innerHTML +=
    `<div class="user">${text}</div>`;
  document.getElementById('input').value = '';

  const res = await fetch('api/continue_session.php', {
    method: 'POST',
    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
    body: 'text=' + encodeURIComponent(text)
  });

  const data = await res.json();
  document.getElementById('chat').innerHTML +=
    `<div class="assistant">${data.assistant}</div>`;
}
</script>

</body>
</html>
